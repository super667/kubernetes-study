# 面试总结

## celery原理

## 部署系统总结

### 为什么做这样一个系统

根据业务需要创建了很多测试环境，每个测试环境都是一个k8s集群，所以面临的是一个多集群管理的问题，

+ 创建yaml文件，由开发使用kubectl去部署
+ 暴露一个统一的部署接口

使用第二种部署方式的优点：

+ 1.测试环境分开发自测环境和测试环境，可以做权限限制

+ 2.开发人员比较多，经常修改并且部署，有可能会有峰值，导致部署失败

+ 3.开发和测试人员也不用学习k8s

+ 4.部署界面可以限制部署的应用，只部署标准应用（）

+ 5.部署前可以检查集群内存，动态扩展节点，减少部署失败次数

### 需要解决哪些问题

+ 1.由于测试环境中部署了nginx，使用了confd和etcd作为服务发现去生成nginx的配置文件，而且服务启动也需要一定的时间，整个服务部署操作是比较耗时的，需要创建异步任务去执行。
+ 2.环境挂掉后，能够快速恢复，或者能够快速复制环境，
+ 3.集群中配置的参数能够持久化，比如nodeport，挂载的volume，dnsmasq访问的域名

### 使用了哪些技术，架构实现

选用的celery+django框架

+ **celery：** celery是一个简单灵活，可靠的分布式系统，可用于处理大量消息，
+ **django：** django是一个比较流行的框架，使用python语言开发，基于django，开发效率比较高
+ **kubernetes客户端：** python版本的kubernetes
+ **redis：** 作为缓存和分布式锁
+ **kafka** 定时任务，定时向daemon进程发送请求检查应用的健康状态，服务器的磁盘，执行特殊命令等，执行结果写入kafka，

## k8s二次开发项目

## 代码中的高可用

1. 重试
2. 告警
3. 